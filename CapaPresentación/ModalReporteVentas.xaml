<Window x:Class="CapaPresentación.ModalReporteVentas"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Reporte de Ventas" 
        Height="600" Width="900"
        WindowStartupLocation="CenterOwner"
        WindowStyle="ToolWindow">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock x:Name="txtTitulo" Text="Reporte de Ventas" FontSize="18" FontWeight="Bold" Margin="15"/>

        <Border Grid.Row="1" Background="#f9f9f9" BorderBrush="#DDD" BorderThickness="0,1,0,1" Padding="10">
            <Button x:Name="btnExportarExcel" Content="📄 Exportar a Excel" 
                    HorizontalAlignment="Left" 
                    Padding="10,5" 
                    Background="#1D6F42" 
                    Foreground="White"
                    Cursor="Hand"
                    Click="btnExportarExcel_Click"/>
        </Border>

        <DataGrid Grid.Row="2" x:Name="dgReporte" AutoGenerateColumns="False" 
                  CanUserAddRows="False" IsReadOnly="True" 
                  HeadersVisibility="Column" Background="White">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Fecha Venta" Binding="{Binding VENTAS.FechaRegistro, StringFormat='dd/MM/yyyy'}" Width="1*"/>
                <DataGridTextColumn Header="Documento" Binding="{Binding VENTAS.NumeroDocumento}" Width="1*"/>
                <DataGridTextColumn Header="Cliente" Binding="{Binding VENTAS.CLIENTES.RazonSocial}" Width="2*"/>
                <DataGridTextColumn Header="Producto" Binding="{Binding LOTES.PRODUCTOS.Nombre}" Width="2*"/>
                <DataGridTextColumn Header="Lote" Binding="{Binding LOTES.NumeroLote}" Width="1*"/>
                <DataGridTextColumn Header="Cantidad" Binding="{Binding Cantidad}" Width="0.6*"/>
                <DataGridTextColumn Header="Precio Unit." Binding="{Binding PrecioVentaUnitario, StringFormat='C'}" Width="1*"/>
                <DataGridTextColumn Header="Subtotal" Binding="{Binding SubTotal, StringFormat='C'}" Width="1*" FontWeight="Bold"/>
            </DataGrid.Columns>
        </DataGrid>

        <Border Grid.Row="3" Background="#eee" BorderBrush="#DDD" BorderThickness="0,1,0,0" Padding="15">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <TextBlock Text="Total General:" FontSize="16" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <TextBlock x:Name="txtTotalGeneral" Text="S/ 0.00" FontSize="16" FontWeight="Bold" VerticalAlignment="Center"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>